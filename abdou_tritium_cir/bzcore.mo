model bzcore "breedingzone system"
  Modelica.Blocks.Interfaces.RealInput from_source annotation(
    Placement(transformation(origin = {-124, 40}, extent = {{-20, -20}, {20, 20}}), iconTransformation(origin = {-117, 40}, extent = {{-20, -20}, {20, 20}})));
  Modelica.Blocks.Interfaces.RealInput from_TES annotation(
    Placement(transformation(origin = {-122, -38}, extent = {{-20, -20}, {20, 20}}), iconTransformation(origin = {-117, -38}, extent = {{-20, -20}, {20, 20}})));
  Modelica.Blocks.Interfaces.RealOutput to_HEx annotation(
    Placement(transformation(origin = {112, 4}, extent = {{-10, -10}, {10, 10}}), iconTransformation(origin = {112, 38}, extent = {{-10, -10}, {10, 10}})));
  Modelica.Blocks.Interfaces.RealOutput to_TES annotation(
    Placement(transformation(origin = {112, 4}, extent = {{-10, -10}, {10, 10}}), iconTransformation(origin = {112, -24}, extent = {{-10, -10}, {10, 10}})));
  Modelica.Blocks.Interfaces.RealOutput loss;
  Modelica.Blocks.Interfaces.RealOutput outflow;
  //Modelica.Blocks.Sources.Constant from_source_fake(k = 0.0202725);
  //Modelica.Blocks.Sources.TimeTable from_TES_fake(table = [0, 0; 0.000766205652463128, 8.63055992061861e-13; 0.00153241130492626, 2.72385290251593e-12; 0.00229861695738938, 5.60336258809430e-12; 0.00592734882234122, 3.22155560558746e-11; 0.00955608068729306, 8.12917249323083e-11; 0.0131848125522449, 1.53152321101112e-10; 0.0168135444171967, 2.47905737312608e-10; 0.0232301296972111, 4.71522941099349e-10; 0.0296467149772255, 7.66733754449617e-10; 0.0360633002572398, 1.13349960731055e-09; 0.0424798855372542, 1.57178063764066e-09; 0.0598694728301567, 3.11880403810514e-09; 0.0772590601230593, 5.19003711400111e-09; 0.0946486474159618, 7.78471462686906e-09; 0.112038234708864, 1.09020757789496e-08; 0.129427822001767, 1.45413621333440e-08; 0.154479385678763, 2.07001496728618e-08; 0.179530949355759, 2.79382800356916e-08; 0.204582513032755, 3.62534943395093e-08; 0.229634076709751, 4.56435370604229e-08; 0.254685640386747, 5.61061564214974e-08; 0.279737204063743, 6.76391043863453e-08; 0.337001249423155, 9.80092138464539e-08; 0.394265294782567, 1.33933435610759e-07; 0.451529340141979, 1.75385129300654e-07; 0.508793385501390, 2.22337751261563e-07; 0.566057430860802, 2.74764854566169e-07; 0.623321476220214, 3.32640088779413e-07; 0.722166741509554, 4.45282201416801e-07; 0.821012006798894, 5.73944644547584e-07; 0.919857272088234, 7.18493905864068e-07; 1.01870253737757, 8.78797313113340e-07; 1.11754780266691, 1.05472302942486e-06; 1.21639306795625, 1.24614004871735e-06; 1.41038705573843, 1.66635287981501e-06; 1.60438104352060, 2.14475964201690e-06; 1.79837503130277, 2.68039746083794e-06; 1.99236901908495, 3.27231537542569e-06; 2.18636300686712, 3.91957420488683e-06; 2.38035699464929, 4.62124642085443e-06; 2.70483389223607, 5.91399199585587e-06; 3.02931078982285, 7.35219308419964e-06; 3.35378768740963, 8.93172198436422e-06; 3.67826458499642, 1.06485368487986e-05; 4.00274148258320, 1.24986800860653e-05; 4.32721838016998, 1.44782768372360e-05; 4.94764397615084, 1.86101206554493e-05; 5.56806957213171, 2.31757294074530e-05; 6.18849516811257, 2.81504166119959e-05; 6.80892076409344, 3.35104856318912e-05; 7.42934636007430, 3.92331941771707e-05; 8.04977195605517, 4.52967213475598e-05; 9.71303939610836, 6.30751044504035e-05; 11.3763068361615, 8.27816158345491e-05; 13.0395742762147, 0.000104082844005256; 14.7028417162679, 0.000126681692096154; 16.3661091563211, 0.000150313834574801; 18.0293765963743, 0.000174744703171576; 20.3699956997717, 0.000210082322786592; 22.7106148031691, 0.000246095883944341; 25.0512339065665, 0.000282370576655579; 27.3918530099639, 0.000318562457925964; 29.7324721133613, 0.000354388855104113; 32.0730912167588, 0.000389620232886418; 37.2039088762842, 0.000463908815427354; 42.3347265358096, 0.000533168131122048; 47.4655441953350, 0.000596725598992511; 52.5963618548605, 0.000654334700466572; 57.7271795143859, 0.000706031763306529; 62.8579971739113, 0.000752046858690220; 72.8579971739113, 0.000826721508658253; 82.8579971739113, 0.000884377369208040; 92.8579971739113, 0.000928362578836065; 102.857997173911, 0.000961567905275661; 112.857997173911, 0.000986378173730491; 122.857997173911, 0.00100476724353779; 132.857997173911, 0.00101832035176348; 142.857997173911, 0.00102828150469401; 152.857997173911, 0.00103559019962718; 162.857997173911, 0.00104094234108403; 172.857997173911, 0.00104485304319693; 182.857997173911, 0.00104770493956986; 192.857997173911, 0.00104978178473884; 202.857997173911, 0.00105129275440499; 212.857997173911, 0.00105239118150054; 222.857997173911, 0.00105318913361789; 232.857997173911, 0.00105376843299485; 242.857997173911, 0.00105418877191212; 252.857997173911, 0.00105449364386525; 262.857997173911, 0.00105471469519382; 272.857997173911, 0.00105487492701932; 282.857997173911, 0.00105499104541719; 292.857997173911, 0.00105507517842060; 302.857997173911, 0.00105513612661344; 312.857997173911, 0.00105518027323768; 322.857997173911, 0.00105521224643833; 332.857997173911, 0.00105523540087281; 342.857997173911, 0.00105525216759808; 352.857997173911, 0.00105526430803270; 362.857997173911, 0.00105527309819965; 372.857997173911, 0.00105527946235604; 382.857997173911, 0.00105528406988938; 392.857997173911, 0.00105528740555614; 402.857997173911, 0.00105528982038099; 412.857997173911, 0.00105529156853373; 422.857997173911, 0.00105529283404338; 432.857997173911, 0.00105529375014818; 442.857997173911, 0.00105529441331001; 452.857997173911, 0.00105529489336326; 462.857997173911, 0.00105529524086389; 472.857997173911, 0.00105529549241066; 482.857997173911, 0.00105529567449783; 492.857997173911, 0.00105529580630462; 500, 0.00105529587778488], timeScale = 1);
  //Modelica.Blocks.Math.Add inflow;
  parameter Real T = 24 "mean residence time";
  parameter Real loss_per = 6.4e-6 "loss per I";
  parameter Real outflow_fraction = 0.01;
  Real I(start=0) "tritium storage in the bz";
equation
  der(I) = (from_TES + from_source) - I/T - loss_per * I;
  outflow = I/T;
  loss = loss_per * I;
  to_HEx = outflow_fraction * outflow;
  to_TES = (1 - outflow_fraction) * outflow;
  
annotation(
    Icon(graphics = {Line(origin = {-100, -100}, points = {{0, 0}, {200, 0}}, color = {0, 0, 127}), Line(origin = {-100, 100}, points = {{0, 0}, {200, 0}}, color = {0, 0, 127}), Line(origin = {-100, -100}, points = {{0, 0}, {0, 200}}, color = {0, 0, 127}), Line(origin = {100, -100}, points = {{0, 0}, {0, 200}}, color = {0, 0, 127}), Text(origin = {-15, 2}, extent = {{-85, 42}, {4, 74}}, textString = "source"), Text(origin = {-37, 4}, extent = {{-71, -64}, {4, -36}}, textString = "TES"), Text(origin = {106, -90}, extent = {{-85, 42}, {4, 74}}, textString = "TES"), Text(origin = {108, -2}, extent = {{-85, 42}, {4, 74}}, textString = "HEx"), Text(origin = {1, -114}, extent = {{-57, 10}, {57, -10}}, textString = "Breeding Zone")}
        ),
        
    uses(Modelica(version = "4.0.0")));
end bzcore;
